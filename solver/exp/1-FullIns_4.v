
From mathcomp Require Import all_ssreflect.
Require Import preliminaries digraph sgraph dom check_ir.

Set Implicit Arguments.
Unset Strict Implicit.
Unset Printing Implicit Defensive.

Set Bullet Behavior "Strict Subproofs".


Definition n := 93.

(**********************************************************************************)
Section Instance.
  Let inst_vert := 'I_n.
  Let inst_adj(u v : nat) :=
    match u, v with
    | 0, 1 => true
    | 0, 3 => true
    | 0, 10 => true
    | 0, 12 => true
    | 0, 31 => true
    | 0, 33 => true
    | 0, 40 => true
    | 0, 42 => true
    | 1, 2 => true
    | 1, 9 => true
    | 1, 11 => true
    | 1, 30 => true
    | 1, 32 => true
    | 1, 39 => true
    | 1, 41 => true
    | 2, 5 => true
    | 2, 7 => true
    | 2, 10 => true
    | 2, 14 => true
    | 2, 16 => true
    | 2, 31 => true
    | 2, 35 => true
    | 2, 37 => true
    | 2, 40 => true
    | 2, 44 => true
    | 2, 46 => true
    | 3, 4 => true
    | 3, 7 => true
    | 3, 9 => true
    | 3, 13 => true
    | 3, 16 => true
    | 3, 30 => true
    | 3, 34 => true
    | 3, 37 => true
    | 3, 39 => true
    | 3, 43 => true
    | 3, 46 => true
    | 4, 6 => true
    | 4, 8 => true
    | 4, 12 => true
    | 4, 15 => true
    | 4, 17 => true
    | 4, 33 => true
    | 4, 36 => true
    | 4, 38 => true
    | 4, 42 => true
    | 4, 45 => true
    | 4, 47 => true
    | 5, 6 => true
    | 5, 8 => true
    | 5, 11 => true
    | 5, 15 => true
    | 5, 17 => true
    | 5, 32 => true
    | 5, 36 => true
    | 5, 38 => true
    | 5, 41 => true
    | 5, 45 => true
    | 5, 47 => true
    | 6, 7 => true
    | 6, 8 => true
    | 6, 13 => true
    | 6, 14 => true
    | 6, 16 => true
    | 6, 17 => true
    | 6, 34 => true
    | 6, 35 => true
    | 6, 37 => true
    | 6, 38 => true
    | 6, 43 => true
    | 6, 44 => true
    | 6, 46 => true
    | 6, 47 => true
    | 7, 8 => true
    | 7, 11 => true
    | 7, 12 => true
    | 7, 15 => true
    | 7, 17 => true
    | 7, 32 => true
    | 7, 33 => true
    | 7, 36 => true
    | 7, 38 => true
    | 7, 41 => true
    | 7, 42 => true
    | 7, 45 => true
    | 7, 47 => true
    | 8, 13 => true
    | 8, 14 => true
    | 8, 15 => true
    | 8, 16 => true
    | 8, 34 => true
    | 8, 35 => true
    | 8, 36 => true
    | 8, 37 => true
    | 8, 43 => true
    | 8, 44 => true
    | 8, 45 => true
    | 8, 46 => true
    | 9, 19 => true
    | 9, 21 => true
    | 9, 28 => true
    | 9, 31 => true
    | 9, 33 => true
    | 9, 49 => true
    | 9, 51 => true
    | 9, 58 => true
    | 10, 18 => true
    | 10, 20 => true
    | 10, 28 => true
    | 10, 30 => true
    | 10, 32 => true
    | 10, 48 => true
    | 10, 50 => true
    | 10, 58 => true
    | 11, 19 => true
    | 11, 23 => true
    | 11, 25 => true
    | 11, 28 => true
    | 11, 31 => true
    | 11, 35 => true
    | 11, 37 => true
    | 11, 49 => true
    | 11, 53 => true
    | 11, 55 => true
    | 11, 58 => true
    | 12, 18 => true
    | 12, 22 => true
    | 12, 25 => true
    | 12, 28 => true
    | 12, 30 => true
    | 12, 34 => true
    | 12, 37 => true
    | 12, 48 => true
    | 12, 52 => true
    | 12, 55 => true
    | 12, 58 => true
    | 13, 21 => true
    | 13, 24 => true
    | 13, 26 => true
    | 13, 28 => true
    | 13, 33 => true
    | 13, 36 => true
    | 13, 38 => true
    | 13, 51 => true
    | 13, 54 => true
    | 13, 56 => true
    | 13, 58 => true
    | 14, 20 => true
    | 14, 24 => true
    | 14, 26 => true
    | 14, 28 => true
    | 14, 32 => true
    | 14, 36 => true
    | 14, 38 => true
    | 14, 50 => true
    | 14, 54 => true
    | 14, 56 => true
    | 14, 58 => true
    | 15, 22 => true
    | 15, 23 => true
    | 15, 25 => true
    | 15, 26 => true
    | 15, 28 => true
    | 15, 34 => true
    | 15, 35 => true
    | 15, 37 => true
    | 15, 38 => true
    | 15, 52 => true
    | 15, 53 => true
    | 15, 55 => true
    | 15, 56 => true
    | 15, 58 => true
    | 16, 20 => true
    | 16, 21 => true
    | 16, 24 => true
    | 16, 26 => true
    | 16, 28 => true
    | 16, 32 => true
    | 16, 33 => true
    | 16, 36 => true
    | 16, 38 => true
    | 16, 50 => true
    | 16, 51 => true
    | 16, 54 => true
    | 16, 56 => true
    | 16, 58 => true
    | 17, 22 => true
    | 17, 23 => true
    | 17, 24 => true
    | 17, 25 => true
    | 17, 28 => true
    | 17, 34 => true
    | 17, 35 => true
    | 17, 36 => true
    | 17, 37 => true
    | 17, 52 => true
    | 17, 53 => true
    | 17, 54 => true
    | 17, 55 => true
    | 17, 58 => true
    | 18, 27 => true
    | 18, 29 => true
    | 18, 40 => true
    | 18, 42 => true
    | 18, 57 => true
    | 18, 59 => true
    | 19, 27 => true
    | 19, 29 => true
    | 19, 39 => true
    | 19, 41 => true
    | 19, 57 => true
    | 19, 59 => true
    | 20, 27 => true
    | 20, 29 => true
    | 20, 40 => true
    | 20, 44 => true
    | 20, 46 => true
    | 20, 57 => true
    | 20, 59 => true
    | 21, 27 => true
    | 21, 29 => true
    | 21, 39 => true
    | 21, 43 => true
    | 21, 46 => true
    | 21, 57 => true
    | 21, 59 => true
    | 22, 27 => true
    | 22, 29 => true
    | 22, 42 => true
    | 22, 45 => true
    | 22, 47 => true
    | 22, 57 => true
    | 22, 59 => true
    | 23, 27 => true
    | 23, 29 => true
    | 23, 41 => true
    | 23, 45 => true
    | 23, 47 => true
    | 23, 57 => true
    | 23, 59 => true
    | 24, 27 => true
    | 24, 29 => true
    | 24, 43 => true
    | 24, 44 => true
    | 24, 46 => true
    | 24, 47 => true
    | 24, 57 => true
    | 24, 59 => true
    | 25, 27 => true
    | 25, 29 => true
    | 25, 41 => true
    | 25, 42 => true
    | 25, 45 => true
    | 25, 47 => true
    | 25, 57 => true
    | 25, 59 => true
    | 26, 27 => true
    | 26, 29 => true
    | 26, 43 => true
    | 26, 44 => true
    | 26, 45 => true
    | 26, 46 => true
    | 26, 57 => true
    | 26, 59 => true
    | 27, 28 => true
    | 27, 29 => true
    | 27, 48 => true
    | 27, 49 => true
    | 27, 50 => true
    | 27, 51 => true
    | 27, 52 => true
    | 27, 53 => true
    | 27, 54 => true
    | 27, 55 => true
    | 27, 56 => true
    | 27, 58 => true
    | 27, 59 => true
    | 28, 29 => true
    | 28, 39 => true
    | 28, 40 => true
    | 28, 41 => true
    | 28, 42 => true
    | 28, 43 => true
    | 28, 44 => true
    | 28, 45 => true
    | 28, 46 => true
    | 28, 47 => true
    | 28, 57 => true
    | 28, 59 => true
    | 29, 48 => true
    | 29, 49 => true
    | 29, 50 => true
    | 29, 51 => true
    | 29, 52 => true
    | 29, 53 => true
    | 29, 54 => true
    | 29, 55 => true
    | 29, 56 => true
    | 29, 57 => true
    | 29, 58 => true
    | 30, 61 => true
    | 30, 63 => true
    | 30, 70 => true
    | 30, 72 => true
    | 30, 91 => true
    | 31, 60 => true
    | 31, 62 => true
    | 31, 69 => true
    | 31, 71 => true
    | 31, 91 => true
    | 32, 61 => true
    | 32, 65 => true
    | 32, 67 => true
    | 32, 70 => true
    | 32, 74 => true
    | 32, 76 => true
    | 32, 91 => true
    | 33, 60 => true
    | 33, 64 => true
    | 33, 67 => true
    | 33, 69 => true
    | 33, 73 => true
    | 33, 76 => true
    | 33, 91 => true
    | 34, 63 => true
    | 34, 66 => true
    | 34, 68 => true
    | 34, 72 => true
    | 34, 75 => true
    | 34, 77 => true
    | 34, 91 => true
    | 35, 62 => true
    | 35, 66 => true
    | 35, 68 => true
    | 35, 71 => true
    | 35, 75 => true
    | 35, 77 => true
    | 35, 91 => true
    | 36, 64 => true
    | 36, 65 => true
    | 36, 67 => true
    | 36, 68 => true
    | 36, 73 => true
    | 36, 74 => true
    | 36, 76 => true
    | 36, 77 => true
    | 36, 91 => true
    | 37, 62 => true
    | 37, 63 => true
    | 37, 66 => true
    | 37, 68 => true
    | 37, 71 => true
    | 37, 72 => true
    | 37, 75 => true
    | 37, 77 => true
    | 37, 91 => true
    | 38, 64 => true
    | 38, 65 => true
    | 38, 66 => true
    | 38, 67 => true
    | 38, 73 => true
    | 38, 74 => true
    | 38, 75 => true
    | 38, 76 => true
    | 38, 91 => true
    | 39, 61 => true
    | 39, 63 => true
    | 39, 79 => true
    | 39, 81 => true
    | 39, 88 => true
    | 39, 91 => true
    | 40, 60 => true
    | 40, 62 => true
    | 40, 78 => true
    | 40, 80 => true
    | 40, 88 => true
    | 40, 91 => true
    | 41, 61 => true
    | 41, 65 => true
    | 41, 67 => true
    | 41, 79 => true
    | 41, 83 => true
    | 41, 85 => true
    | 41, 88 => true
    | 41, 91 => true
    | 42, 60 => true
    | 42, 64 => true
    | 42, 67 => true
    | 42, 78 => true
    | 42, 82 => true
    | 42, 85 => true
    | 42, 88 => true
    | 42, 91 => true
    | 43, 63 => true
    | 43, 66 => true
    | 43, 68 => true
    | 43, 81 => true
    | 43, 84 => true
    | 43, 86 => true
    | 43, 88 => true
    | 43, 91 => true
    | 44, 62 => true
    | 44, 66 => true
    | 44, 68 => true
    | 44, 80 => true
    | 44, 84 => true
    | 44, 86 => true
    | 44, 88 => true
    | 44, 91 => true
    | 45, 64 => true
    | 45, 65 => true
    | 45, 67 => true
    | 45, 68 => true
    | 45, 82 => true
    | 45, 83 => true
    | 45, 85 => true
    | 45, 86 => true
    | 45, 88 => true
    | 45, 91 => true
    | 46, 62 => true
    | 46, 63 => true
    | 46, 66 => true
    | 46, 68 => true
    | 46, 80 => true
    | 46, 81 => true
    | 46, 84 => true
    | 46, 86 => true
    | 46, 88 => true
    | 46, 91 => true
    | 47, 64 => true
    | 47, 65 => true
    | 47, 66 => true
    | 47, 67 => true
    | 47, 82 => true
    | 47, 83 => true
    | 47, 84 => true
    | 47, 85 => true
    | 47, 88 => true
    | 47, 91 => true
    | 48, 70 => true
    | 48, 72 => true
    | 48, 87 => true
    | 48, 89 => true
    | 48, 91 => true
    | 49, 69 => true
    | 49, 71 => true
    | 49, 87 => true
    | 49, 89 => true
    | 49, 91 => true
    | 50, 70 => true
    | 50, 74 => true
    | 50, 76 => true
    | 50, 87 => true
    | 50, 89 => true
    | 50, 91 => true
    | 51, 69 => true
    | 51, 73 => true
    | 51, 76 => true
    | 51, 87 => true
    | 51, 89 => true
    | 51, 91 => true
    | 52, 72 => true
    | 52, 75 => true
    | 52, 77 => true
    | 52, 87 => true
    | 52, 89 => true
    | 52, 91 => true
    | 53, 71 => true
    | 53, 75 => true
    | 53, 77 => true
    | 53, 87 => true
    | 53, 89 => true
    | 53, 91 => true
    | 54, 73 => true
    | 54, 74 => true
    | 54, 76 => true
    | 54, 77 => true
    | 54, 87 => true
    | 54, 89 => true
    | 54, 91 => true
    | 55, 71 => true
    | 55, 72 => true
    | 55, 75 => true
    | 55, 77 => true
    | 55, 87 => true
    | 55, 89 => true
    | 55, 91 => true
    | 56, 73 => true
    | 56, 74 => true
    | 56, 75 => true
    | 56, 76 => true
    | 56, 87 => true
    | 56, 89 => true
    | 56, 91 => true
    | 57, 78 => true
    | 57, 79 => true
    | 57, 80 => true
    | 57, 81 => true
    | 57, 82 => true
    | 57, 83 => true
    | 57, 84 => true
    | 57, 85 => true
    | 57, 86 => true
    | 57, 88 => true
    | 57, 89 => true
    | 57, 91 => true
    | 58, 69 => true
    | 58, 70 => true
    | 58, 71 => true
    | 58, 72 => true
    | 58, 73 => true
    | 58, 74 => true
    | 58, 75 => true
    | 58, 76 => true
    | 58, 77 => true
    | 58, 87 => true
    | 58, 89 => true
    | 58, 91 => true
    | 59, 78 => true
    | 59, 79 => true
    | 59, 80 => true
    | 59, 81 => true
    | 59, 82 => true
    | 59, 83 => true
    | 59, 84 => true
    | 59, 85 => true
    | 59, 86 => true
    | 59, 87 => true
    | 59, 88 => true
    | 59, 91 => true
    | 60, 90 => true
    | 60, 92 => true
    | 61, 90 => true
    | 61, 92 => true
    | 62, 90 => true
    | 62, 92 => true
    | 63, 90 => true
    | 63, 92 => true
    | 64, 90 => true
    | 64, 92 => true
    | 65, 90 => true
    | 65, 92 => true
    | 66, 90 => true
    | 66, 92 => true
    | 67, 90 => true
    | 67, 92 => true
    | 68, 90 => true
    | 68, 92 => true
    | 69, 90 => true
    | 69, 92 => true
    | 70, 90 => true
    | 70, 92 => true
    | 71, 90 => true
    | 71, 92 => true
    | 72, 90 => true
    | 72, 92 => true
    | 73, 90 => true
    | 73, 92 => true
    | 74, 90 => true
    | 74, 92 => true
    | 75, 90 => true
    | 75, 92 => true
    | 76, 90 => true
    | 76, 92 => true
    | 77, 90 => true
    | 77, 92 => true
    | 78, 90 => true
    | 78, 92 => true
    | 79, 90 => true
    | 79, 92 => true
    | 80, 90 => true
    | 80, 92 => true
    | 81, 90 => true
    | 81, 92 => true
    | 82, 90 => true
    | 82, 92 => true
    | 83, 90 => true
    | 83, 92 => true
    | 84, 90 => true
    | 84, 92 => true
    | 85, 90 => true
    | 85, 92 => true
    | 86, 90 => true
    | 86, 92 => true
    | 87, 90 => true
    | 87, 92 => true
    | 88, 90 => true
    | 88, 92 => true
    | 89, 90 => true
    | 89, 92 => true
    | 90, 91 => true
    | 90, 92 => true
    | 91, 92 => true
    | _, _ => false
    end.

  Let inst_rel := [ rel u v : inst_vert | give_sg inst_adj u v ].
  Let inst_sym : symmetric inst_rel. Proof. exact: give_sg_sym. Qed.
  Let inst_irrefl : irreflexive inst_rel. Proof. exact: give_sg_irrefl. Qed.
  Definition inst := SGraph inst_sym inst_irrefl.
End Instance.

Notation "''v' m" := (@Ordinal n m isT) (at level 0, m at level 8, format "''v' m").

(**********************************************************************************)
Section Certificate.
  Let inst_set := [set 'v0; 'v4; 'v5; 'v7; 'v18; 'v19; 'v20; 'v21; 'v22; 'v23; 'v24; 'v25; 'v26; 'v28; 'v60; 'v61; 'v62; 'v63; 'v64; 'v65; 'v66; 'v67; 'v68; 'v69; 'v70; 'v71; 'v72; 'v73; 'v74; 'v75; 'v76; 'v77; 'v78; 'v79; 'v80; 'v81; 'v82; 'v83; 'v84; 'v85; 'v86; 'v87; 'v88; 'v89; 'v91].

  Section List_of_Set.
    Definition inst_list := [:: 'v0; 'v4; 'v5; 'v7; 'v18; 'v19; 'v20; 'v21; 'v22; 'v23; 'v24; 'v25; 'v26; 'v28; 'v60; 'v61; 'v62; 'v63; 'v64; 'v65; 'v66; 'v67; 'v68; 'v69; 'v70; 'v71; 'v72; 'v73; 'v74; 'v75; 'v76; 'v77; 'v78; 'v79; 'v80; 'v81; 'v82; 'v83; 'v84; 'v85; 'v86; 'v87; 'v88; 'v89; 'v91].

    Fact inst_list_eq_inst_set : inst_list =i inst_set.
    Proof. by move=> v ; rewrite !inE /= ; try rewrite !orbA. Qed.

    Fact inst_list_uniq : uniq inst_list.
    Proof. done. Qed.
  End List_of_Set.

  Fact inst_set_card : #|inst_set| = 45.
  Proof. by rewrite -(eq_card inst_list_eq_inst_set) (card_uniqP inst_list_uniq). Qed.

  Fact inst_set_is_irr : @irredundant inst inst_set.
  Proof.
    apply (irredundant_checkP inst inst_list (ord_enum_eqT n)).
    - exact: inst_list_uniq.
    - exact: inst_list_eq_inst_set.
    - done.
  Qed.

  Fact IR_lb : IR inst >= 45.
  Proof.
    rewrite eq_IR_IR1 ; move: inst_set_card ; rewrite (@cardwset1 inst inst_set).
    move<- ; apply: IR_max ; exact: inst_set_is_irr.
  Qed.

End Certificate.
