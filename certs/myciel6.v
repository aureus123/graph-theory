
From mathcomp Require Import all_ssreflect.
From GraphTheory Require Import preliminaries digraph sgraph dom.
Require Import check_ir prelim.

Set Implicit Arguments.
Unset Strict Implicit.
Unset Printing Implicit Defensive.

Set Bullet Behavior "Strict Subproofs".


Definition n := 95.

(**********************************************************************************)
Section Instance.
  Let inst_vert := 'I_n.
  Let inst_adj(u v : nat) :=
    match u, v with
    | 0, 1 => true
    | 0, 3 => true
    | 0, 6 => true
    | 0, 8 => true
    | 0, 12 => true
    | 0, 14 => true
    | 0, 17 => true
    | 0, 19 => true
    | 0, 24 => true
    | 0, 26 => true
    | 0, 29 => true
    | 0, 31 => true
    | 0, 35 => true
    | 0, 37 => true
    | 0, 40 => true
    | 0, 42 => true
    | 0, 48 => true
    | 0, 50 => true
    | 0, 53 => true
    | 0, 55 => true
    | 0, 59 => true
    | 0, 61 => true
    | 0, 64 => true
    | 0, 66 => true
    | 0, 71 => true
    | 0, 73 => true
    | 0, 76 => true
    | 0, 78 => true
    | 0, 82 => true
    | 0, 84 => true
    | 0, 87 => true
    | 0, 89 => true
    | 1, 2 => true
    | 1, 5 => true
    | 1, 7 => true
    | 1, 11 => true
    | 1, 13 => true
    | 1, 16 => true
    | 1, 18 => true
    | 1, 23 => true
    | 1, 25 => true
    | 1, 28 => true
    | 1, 30 => true
    | 1, 34 => true
    | 1, 36 => true
    | 1, 39 => true
    | 1, 41 => true
    | 1, 47 => true
    | 1, 49 => true
    | 1, 52 => true
    | 1, 54 => true
    | 1, 58 => true
    | 1, 60 => true
    | 1, 63 => true
    | 1, 65 => true
    | 1, 70 => true
    | 1, 72 => true
    | 1, 75 => true
    | 1, 77 => true
    | 1, 81 => true
    | 1, 83 => true
    | 1, 86 => true
    | 1, 88 => true
    | 2, 4 => true
    | 2, 6 => true
    | 2, 9 => true
    | 2, 12 => true
    | 2, 15 => true
    | 2, 17 => true
    | 2, 20 => true
    | 2, 24 => true
    | 2, 27 => true
    | 2, 29 => true
    | 2, 32 => true
    | 2, 35 => true
    | 2, 38 => true
    | 2, 40 => true
    | 2, 43 => true
    | 2, 48 => true
    | 2, 51 => true
    | 2, 53 => true
    | 2, 56 => true
    | 2, 59 => true
    | 2, 62 => true
    | 2, 64 => true
    | 2, 67 => true
    | 2, 71 => true
    | 2, 74 => true
    | 2, 76 => true
    | 2, 79 => true
    | 2, 82 => true
    | 2, 85 => true
    | 2, 87 => true
    | 2, 90 => true
    | 3, 4 => true
    | 3, 5 => true
    | 3, 9 => true
    | 3, 11 => true
    | 3, 15 => true
    | 3, 16 => true
    | 3, 20 => true
    | 3, 23 => true
    | 3, 27 => true
    | 3, 28 => true
    | 3, 32 => true
    | 3, 34 => true
    | 3, 38 => true
    | 3, 39 => true
    | 3, 43 => true
    | 3, 47 => true
    | 3, 51 => true
    | 3, 52 => true
    | 3, 56 => true
    | 3, 58 => true
    | 3, 62 => true
    | 3, 63 => true
    | 3, 67 => true
    | 3, 70 => true
    | 3, 74 => true
    | 3, 75 => true
    | 3, 79 => true
    | 3, 81 => true
    | 3, 85 => true
    | 3, 86 => true
    | 3, 90 => true
    | 4, 7 => true
    | 4, 8 => true
    | 4, 13 => true
    | 4, 14 => true
    | 4, 18 => true
    | 4, 19 => true
    | 4, 25 => true
    | 4, 26 => true
    | 4, 30 => true
    | 4, 31 => true
    | 4, 36 => true
    | 4, 37 => true
    | 4, 41 => true
    | 4, 42 => true
    | 4, 49 => true
    | 4, 50 => true
    | 4, 54 => true
    | 4, 55 => true
    | 4, 60 => true
    | 4, 61 => true
    | 4, 65 => true
    | 4, 66 => true
    | 4, 72 => true
    | 4, 73 => true
    | 4, 77 => true
    | 4, 78 => true
    | 4, 83 => true
    | 4, 84 => true
    | 4, 88 => true
    | 4, 89 => true
    | 5, 10 => true
    | 5, 12 => true
    | 5, 14 => true
    | 5, 21 => true
    | 5, 24 => true
    | 5, 26 => true
    | 5, 33 => true
    | 5, 35 => true
    | 5, 37 => true
    | 5, 44 => true
    | 5, 48 => true
    | 5, 50 => true
    | 5, 57 => true
    | 5, 59 => true
    | 5, 61 => true
    | 5, 68 => true
    | 5, 71 => true
    | 5, 73 => true
    | 5, 80 => true
    | 5, 82 => true
    | 5, 84 => true
    | 5, 91 => true
    | 6, 10 => true
    | 6, 11 => true
    | 6, 13 => true
    | 6, 21 => true
    | 6, 23 => true
    | 6, 25 => true
    | 6, 33 => true
    | 6, 34 => true
    | 6, 36 => true
    | 6, 44 => true
    | 6, 47 => true
    | 6, 49 => true
    | 6, 57 => true
    | 6, 58 => true
    | 6, 60 => true
    | 6, 68 => true
    | 6, 70 => true
    | 6, 72 => true
    | 6, 80 => true
    | 6, 81 => true
    | 6, 83 => true
    | 6, 91 => true
    | 7, 10 => true
    | 7, 12 => true
    | 7, 15 => true
    | 7, 21 => true
    | 7, 24 => true
    | 7, 27 => true
    | 7, 33 => true
    | 7, 35 => true
    | 7, 38 => true
    | 7, 44 => true
    | 7, 48 => true
    | 7, 51 => true
    | 7, 57 => true
    | 7, 59 => true
    | 7, 62 => true
    | 7, 68 => true
    | 7, 71 => true
    | 7, 74 => true
    | 7, 80 => true
    | 7, 82 => true
    | 7, 85 => true
    | 7, 91 => true
    | 8, 10 => true
    | 8, 11 => true
    | 8, 15 => true
    | 8, 21 => true
    | 8, 23 => true
    | 8, 27 => true
    | 8, 33 => true
    | 8, 34 => true
    | 8, 38 => true
    | 8, 44 => true
    | 8, 47 => true
    | 8, 51 => true
    | 8, 57 => true
    | 8, 58 => true
    | 8, 62 => true
    | 8, 68 => true
    | 8, 70 => true
    | 8, 74 => true
    | 8, 80 => true
    | 8, 81 => true
    | 8, 85 => true
    | 8, 91 => true
    | 9, 10 => true
    | 9, 13 => true
    | 9, 14 => true
    | 9, 21 => true
    | 9, 25 => true
    | 9, 26 => true
    | 9, 33 => true
    | 9, 36 => true
    | 9, 37 => true
    | 9, 44 => true
    | 9, 49 => true
    | 9, 50 => true
    | 9, 57 => true
    | 9, 60 => true
    | 9, 61 => true
    | 9, 68 => true
    | 9, 72 => true
    | 9, 73 => true
    | 9, 80 => true
    | 9, 83 => true
    | 9, 84 => true
    | 9, 91 => true
    | 10, 16 => true
    | 10, 17 => true
    | 10, 18 => true
    | 10, 19 => true
    | 10, 20 => true
    | 10, 28 => true
    | 10, 29 => true
    | 10, 30 => true
    | 10, 31 => true
    | 10, 32 => true
    | 10, 39 => true
    | 10, 40 => true
    | 10, 41 => true
    | 10, 42 => true
    | 10, 43 => true
    | 10, 52 => true
    | 10, 53 => true
    | 10, 54 => true
    | 10, 55 => true
    | 10, 56 => true
    | 10, 63 => true
    | 10, 64 => true
    | 10, 65 => true
    | 10, 66 => true
    | 10, 67 => true
    | 10, 75 => true
    | 10, 76 => true
    | 10, 77 => true
    | 10, 78 => true
    | 10, 79 => true
    | 10, 86 => true
    | 10, 87 => true
    | 10, 88 => true
    | 10, 89 => true
    | 10, 90 => true
    | 11, 22 => true
    | 11, 24 => true
    | 11, 26 => true
    | 11, 29 => true
    | 11, 31 => true
    | 11, 45 => true
    | 11, 48 => true
    | 11, 50 => true
    | 11, 53 => true
    | 11, 55 => true
    | 11, 69 => true
    | 11, 71 => true
    | 11, 73 => true
    | 11, 76 => true
    | 11, 78 => true
    | 11, 92 => true
    | 12, 22 => true
    | 12, 23 => true
    | 12, 25 => true
    | 12, 28 => true
    | 12, 30 => true
    | 12, 45 => true
    | 12, 47 => true
    | 12, 49 => true
    | 12, 52 => true
    | 12, 54 => true
    | 12, 69 => true
    | 12, 70 => true
    | 12, 72 => true
    | 12, 75 => true
    | 12, 77 => true
    | 12, 92 => true
    | 13, 22 => true
    | 13, 24 => true
    | 13, 27 => true
    | 13, 29 => true
    | 13, 32 => true
    | 13, 45 => true
    | 13, 48 => true
    | 13, 51 => true
    | 13, 53 => true
    | 13, 56 => true
    | 13, 69 => true
    | 13, 71 => true
    | 13, 74 => true
    | 13, 76 => true
    | 13, 79 => true
    | 13, 92 => true
    | 14, 22 => true
    | 14, 23 => true
    | 14, 27 => true
    | 14, 28 => true
    | 14, 32 => true
    | 14, 45 => true
    | 14, 47 => true
    | 14, 51 => true
    | 14, 52 => true
    | 14, 56 => true
    | 14, 69 => true
    | 14, 70 => true
    | 14, 74 => true
    | 14, 75 => true
    | 14, 79 => true
    | 14, 92 => true
    | 15, 22 => true
    | 15, 25 => true
    | 15, 26 => true
    | 15, 30 => true
    | 15, 31 => true
    | 15, 45 => true
    | 15, 49 => true
    | 15, 50 => true
    | 15, 54 => true
    | 15, 55 => true
    | 15, 69 => true
    | 15, 72 => true
    | 15, 73 => true
    | 15, 77 => true
    | 15, 78 => true
    | 15, 92 => true
    | 16, 22 => true
    | 16, 24 => true
    | 16, 26 => true
    | 16, 33 => true
    | 16, 45 => true
    | 16, 48 => true
    | 16, 50 => true
    | 16, 57 => true
    | 16, 69 => true
    | 16, 71 => true
    | 16, 73 => true
    | 16, 80 => true
    | 16, 92 => true
    | 17, 22 => true
    | 17, 23 => true
    | 17, 25 => true
    | 17, 33 => true
    | 17, 45 => true
    | 17, 47 => true
    | 17, 49 => true
    | 17, 57 => true
    | 17, 69 => true
    | 17, 70 => true
    | 17, 72 => true
    | 17, 80 => true
    | 17, 92 => true
    | 18, 22 => true
    | 18, 24 => true
    | 18, 27 => true
    | 18, 33 => true
    | 18, 45 => true
    | 18, 48 => true
    | 18, 51 => true
    | 18, 57 => true
    | 18, 69 => true
    | 18, 71 => true
    | 18, 74 => true
    | 18, 80 => true
    | 18, 92 => true
    | 19, 22 => true
    | 19, 23 => true
    | 19, 27 => true
    | 19, 33 => true
    | 19, 45 => true
    | 19, 47 => true
    | 19, 51 => true
    | 19, 57 => true
    | 19, 69 => true
    | 19, 70 => true
    | 19, 74 => true
    | 19, 80 => true
    | 19, 92 => true
    | 20, 22 => true
    | 20, 25 => true
    | 20, 26 => true
    | 20, 33 => true
    | 20, 45 => true
    | 20, 49 => true
    | 20, 50 => true
    | 20, 57 => true
    | 20, 69 => true
    | 20, 72 => true
    | 20, 73 => true
    | 20, 80 => true
    | 20, 92 => true
    | 21, 22 => true
    | 21, 28 => true
    | 21, 29 => true
    | 21, 30 => true
    | 21, 31 => true
    | 21, 32 => true
    | 21, 45 => true
    | 21, 52 => true
    | 21, 53 => true
    | 21, 54 => true
    | 21, 55 => true
    | 21, 56 => true
    | 21, 69 => true
    | 21, 75 => true
    | 21, 76 => true
    | 21, 77 => true
    | 21, 78 => true
    | 21, 79 => true
    | 21, 92 => true
    | 22, 34 => true
    | 22, 35 => true
    | 22, 36 => true
    | 22, 37 => true
    | 22, 38 => true
    | 22, 39 => true
    | 22, 40 => true
    | 22, 41 => true
    | 22, 42 => true
    | 22, 43 => true
    | 22, 44 => true
    | 22, 58 => true
    | 22, 59 => true
    | 22, 60 => true
    | 22, 61 => true
    | 22, 62 => true
    | 22, 63 => true
    | 22, 64 => true
    | 22, 65 => true
    | 22, 66 => true
    | 22, 67 => true
    | 22, 68 => true
    | 22, 81 => true
    | 22, 82 => true
    | 22, 83 => true
    | 22, 84 => true
    | 22, 85 => true
    | 22, 86 => true
    | 22, 87 => true
    | 22, 88 => true
    | 22, 89 => true
    | 22, 90 => true
    | 22, 91 => true
    | 23, 46 => true
    | 23, 48 => true
    | 23, 50 => true
    | 23, 53 => true
    | 23, 55 => true
    | 23, 59 => true
    | 23, 61 => true
    | 23, 64 => true
    | 23, 66 => true
    | 23, 93 => true
    | 24, 46 => true
    | 24, 47 => true
    | 24, 49 => true
    | 24, 52 => true
    | 24, 54 => true
    | 24, 58 => true
    | 24, 60 => true
    | 24, 63 => true
    | 24, 65 => true
    | 24, 93 => true
    | 25, 46 => true
    | 25, 48 => true
    | 25, 51 => true
    | 25, 53 => true
    | 25, 56 => true
    | 25, 59 => true
    | 25, 62 => true
    | 25, 64 => true
    | 25, 67 => true
    | 25, 93 => true
    | 26, 46 => true
    | 26, 47 => true
    | 26, 51 => true
    | 26, 52 => true
    | 26, 56 => true
    | 26, 58 => true
    | 26, 62 => true
    | 26, 63 => true
    | 26, 67 => true
    | 26, 93 => true
    | 27, 46 => true
    | 27, 49 => true
    | 27, 50 => true
    | 27, 54 => true
    | 27, 55 => true
    | 27, 60 => true
    | 27, 61 => true
    | 27, 65 => true
    | 27, 66 => true
    | 27, 93 => true
    | 28, 46 => true
    | 28, 48 => true
    | 28, 50 => true
    | 28, 57 => true
    | 28, 59 => true
    | 28, 61 => true
    | 28, 68 => true
    | 28, 93 => true
    | 29, 46 => true
    | 29, 47 => true
    | 29, 49 => true
    | 29, 57 => true
    | 29, 58 => true
    | 29, 60 => true
    | 29, 68 => true
    | 29, 93 => true
    | 30, 46 => true
    | 30, 48 => true
    | 30, 51 => true
    | 30, 57 => true
    | 30, 59 => true
    | 30, 62 => true
    | 30, 68 => true
    | 30, 93 => true
    | 31, 46 => true
    | 31, 47 => true
    | 31, 51 => true
    | 31, 57 => true
    | 31, 58 => true
    | 31, 62 => true
    | 31, 68 => true
    | 31, 93 => true
    | 32, 46 => true
    | 32, 49 => true
    | 32, 50 => true
    | 32, 57 => true
    | 32, 60 => true
    | 32, 61 => true
    | 32, 68 => true
    | 32, 93 => true
    | 33, 46 => true
    | 33, 52 => true
    | 33, 53 => true
    | 33, 54 => true
    | 33, 55 => true
    | 33, 56 => true
    | 33, 63 => true
    | 33, 64 => true
    | 33, 65 => true
    | 33, 66 => true
    | 33, 67 => true
    | 33, 93 => true
    | 34, 46 => true
    | 34, 48 => true
    | 34, 50 => true
    | 34, 53 => true
    | 34, 55 => true
    | 34, 69 => true
    | 34, 93 => true
    | 35, 46 => true
    | 35, 47 => true
    | 35, 49 => true
    | 35, 52 => true
    | 35, 54 => true
    | 35, 69 => true
    | 35, 93 => true
    | 36, 46 => true
    | 36, 48 => true
    | 36, 51 => true
    | 36, 53 => true
    | 36, 56 => true
    | 36, 69 => true
    | 36, 93 => true
    | 37, 46 => true
    | 37, 47 => true
    | 37, 51 => true
    | 37, 52 => true
    | 37, 56 => true
    | 37, 69 => true
    | 37, 93 => true
    | 38, 46 => true
    | 38, 49 => true
    | 38, 50 => true
    | 38, 54 => true
    | 38, 55 => true
    | 38, 69 => true
    | 38, 93 => true
    | 39, 46 => true
    | 39, 48 => true
    | 39, 50 => true
    | 39, 57 => true
    | 39, 69 => true
    | 39, 93 => true
    | 40, 46 => true
    | 40, 47 => true
    | 40, 49 => true
    | 40, 57 => true
    | 40, 69 => true
    | 40, 93 => true
    | 41, 46 => true
    | 41, 48 => true
    | 41, 51 => true
    | 41, 57 => true
    | 41, 69 => true
    | 41, 93 => true
    | 42, 46 => true
    | 42, 47 => true
    | 42, 51 => true
    | 42, 57 => true
    | 42, 69 => true
    | 42, 93 => true
    | 43, 46 => true
    | 43, 49 => true
    | 43, 50 => true
    | 43, 57 => true
    | 43, 69 => true
    | 43, 93 => true
    | 44, 46 => true
    | 44, 52 => true
    | 44, 53 => true
    | 44, 54 => true
    | 44, 55 => true
    | 44, 56 => true
    | 44, 69 => true
    | 44, 93 => true
    | 45, 46 => true
    | 45, 58 => true
    | 45, 59 => true
    | 45, 60 => true
    | 45, 61 => true
    | 45, 62 => true
    | 45, 63 => true
    | 45, 64 => true
    | 45, 65 => true
    | 45, 66 => true
    | 45, 67 => true
    | 45, 68 => true
    | 45, 93 => true
    | 46, 70 => true
    | 46, 71 => true
    | 46, 72 => true
    | 46, 73 => true
    | 46, 74 => true
    | 46, 75 => true
    | 46, 76 => true
    | 46, 77 => true
    | 46, 78 => true
    | 46, 79 => true
    | 46, 80 => true
    | 46, 81 => true
    | 46, 82 => true
    | 46, 83 => true
    | 46, 84 => true
    | 46, 85 => true
    | 46, 86 => true
    | 46, 87 => true
    | 46, 88 => true
    | 46, 89 => true
    | 46, 90 => true
    | 46, 91 => true
    | 46, 92 => true
    | 47, 94 => true
    | 48, 94 => true
    | 49, 94 => true
    | 50, 94 => true
    | 51, 94 => true
    | 52, 94 => true
    | 53, 94 => true
    | 54, 94 => true
    | 55, 94 => true
    | 56, 94 => true
    | 57, 94 => true
    | 58, 94 => true
    | 59, 94 => true
    | 60, 94 => true
    | 61, 94 => true
    | 62, 94 => true
    | 63, 94 => true
    | 64, 94 => true
    | 65, 94 => true
    | 66, 94 => true
    | 67, 94 => true
    | 68, 94 => true
    | 69, 94 => true
    | 70, 94 => true
    | 71, 94 => true
    | 72, 94 => true
    | 73, 94 => true
    | 74, 94 => true
    | 75, 94 => true
    | 76, 94 => true
    | 77, 94 => true
    | 78, 94 => true
    | 79, 94 => true
    | 80, 94 => true
    | 81, 94 => true
    | 82, 94 => true
    | 83, 94 => true
    | 84, 94 => true
    | 85, 94 => true
    | 86, 94 => true
    | 87, 94 => true
    | 88, 94 => true
    | 89, 94 => true
    | 90, 94 => true
    | 91, 94 => true
    | 92, 94 => true
    | 93, 94 => true
    | _, _ => false
    end.

  Let inst_rel := [ rel u v : inst_vert | give_sg inst_adj u v ].
  Let inst_sym : symmetric inst_rel. Proof. exact: give_sg_sym. Qed.
  Let inst_irrefl : irreflexive inst_rel. Proof. exact: give_sg_irrefl. Qed.
  Definition inst := SGraph inst_sym inst_irrefl.
End Instance.

Notation "''v' m" := (@Ordinal n m isT) (at level 0, m at level 8, format "''v' m").

(**********************************************************************************)
Section Certificate.
  Let inst_set := [set 'v47; 'v48; 'v49; 'v50; 'v51; 'v52; 'v53; 'v54; 'v55; 'v56; 'v57; 'v58; 'v59; 'v60; 'v61; 'v62; 'v63; 'v64; 'v65; 'v66; 'v67; 'v68; 'v69; 'v70; 'v71; 'v72; 'v73; 'v74; 'v75; 'v76; 'v77; 'v78; 'v79; 'v80; 'v81; 'v82; 'v83; 'v84; 'v85; 'v86; 'v87; 'v88; 'v89; 'v90; 'v91; 'v92; 'v93].

  Section List_of_Set.
    Definition inst_list := [:: 'v47; 'v48; 'v49; 'v50; 'v51; 'v52; 'v53; 'v54; 'v55; 'v56; 'v57; 'v58; 'v59; 'v60; 'v61; 'v62; 'v63; 'v64; 'v65; 'v66; 'v67; 'v68; 'v69; 'v70; 'v71; 'v72; 'v73; 'v74; 'v75; 'v76; 'v77; 'v78; 'v79; 'v80; 'v81; 'v82; 'v83; 'v84; 'v85; 'v86; 'v87; 'v88; 'v89; 'v90; 'v91; 'v92; 'v93].

    Fact inst_list_eq_inst_set : inst_list =i inst_set.
    Proof. by move=> v ; rewrite !inE ; try rewrite !orbA. Qed.

    Fact inst_list_uniq : uniq inst_list.
    Proof. done. Qed.
  End List_of_Set.

  Fact inst_set_card : #|inst_set| = 47.
  Proof. by rewrite -(eq_card inst_list_eq_inst_set) (card_uniqP inst_list_uniq). Qed.

  Fact inst_set_is_irr : @irredundant inst inst_set.
  Proof.
    apply (irredundant_checkP inst inst_list (ord_enum_eqT n)).
    - exact: inst_list_uniq.
    - exact: inst_list_eq_inst_set.
    - done.
  Qed.

  Fact IR_lb : IR inst >= 47.
  Proof.
    rewrite eq_IR_IR1 ; move: inst_set_card ; rewrite (@cardwset1 inst inst_set).
    move<- ; apply: IR_max ; exact: inst_set_is_irr.
  Qed.

End Certificate.
